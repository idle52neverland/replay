<!-- index.html (카테고리별 JS 파일 통합 로딩 버전) -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>I-DLE 몬8아보기</title>
  <style>
    /* (생략: CSS는 기존 그대로 유지) */
  </style>
</head>
<body>
  <!-- (생략: 상단 UI 구조 기존 그대로 유지) -->

  <div class="card-container" id="allCards"></div>

  <div class="button-wrapper">
    <button id="loadMoreBtn" type="button">More</button>
    <button id="scrollTopBtn" title="위로 가기">↑</button>
  </div>

  <!-- ✅ 카테고리별 카드 JS 파일 로딩 -->
  <script src="js/cards-MV_SPECIAL_CLIP.js"></script>
  <script src="js/cards-RECORDING_BEHIND.js"></script>
  <script src="js/cards-I_SERIES.js"></script>
  <script src="js/cards-I_VARIETY.js"></script>
  <script src="js/cards-STAGE_PERFORMANCE.js"></script>
  <script src="js/cards-LIVE_COVER_DANCE.js"></script>
  <script src="js/cards-BEHIND_CLIPS.js"></script>
  <script src="js/cards-MEDIA_CONTENTS.js"></script>
  <script src="js/cards-RADIO_PODCAST.js"></script>
  <script src="js/cards-INTERVIEW.js"></script>
  <script src="js/cards-LIVE_STREAM.js"></script>
  <script src="js/cards-FANCAM.js"></script>
  <script src="js/cards-CHALLENGE.js"></script>
  <script src="js/cards-ETC.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const container = document.getElementById("allCards");
      const loadMoreBtn = document.getElementById("loadMoreBtn");
      const scrollTopBtn = document.getElementById("scrollTopBtn");
      const searchInput = document.getElementById("searchInput");
      const resetSearchBtn = document.getElementById("resetSearchBtn");

      let currentIndex = 0;
      const batchSize = 30;

      // ✅ 통합 배열 생성 (카테고리별 전역 배열 합치기)
      const all = [].concat(
        mvSpecialClipCards,
        recordingBehindCards,
        iSeriesCards,
        iVarietyCards,
        stagePerformanceCards,
        liveCoverDanceCards,
        behindClipsCards,
        mediaContentsCards,
        radioPodcastCards,
        interviewCards,
        liveStreamCards,
        fancamCards,
        challengeCards,
        etcCards
      );

      function extractDate(title) {
        const match = title.match(/\((\d{4}-\d{2}-\d{2})\)/);
        return match ? match[1] : '2000-01-01';
      }

      all.sort((a, b) => new Date(extractDate(b.title)) - new Date(extractDate(a.title)));
      let filtered = all;

      function renderCards(cards) {
        container.innerHTML = '';
        cards.slice(0, currentIndex + batchSize).forEach(data => {
          const card = document.createElement("a");
          card.className = "card";
          card.setAttribute("data-category", data.category);
          card.setAttribute("data-member", data.member);
          card.setAttribute("data-year", data.year);
          card.innerHTML = `
            <img src="${data.thumbnail}" alt="${data.alt}">
            <div class="card-title">${data.title}</div>
          `;
          card.addEventListener("click", (e) => {
            e.preventDefault();
            e.stopPropagation();
            window.open(data.link, "_blank");
          });
          container.appendChild(card);
        });
        currentIndex += batchSize;
        loadMoreBtn.style.display = currentIndex >= cards.length ? "none" : "block";
      }

      renderCards(filtered);

      loadMoreBtn.addEventListener("click", () => renderCards(filtered));

      searchInput.addEventListener("input", function () {
        const keywords = this.value.toLowerCase().split(/[\s,]+/);
        filtered = all.filter(c =>
          keywords.every(kw => c.title.toLowerCase().includes(kw))
        );
        currentIndex = 0;
        renderCards(filtered);
      });

      resetSearchBtn.addEventListener("click", () => {
        searchInput.value = '';
        filtered = all;
        currentIndex = 0;
        renderCards(filtered);
      });

      scrollTopBtn.addEventListener("click", () => {
        window.scrollTo({ top: 0, behavior: "smooth" });
      });
    });
  </script>
</body>
</html>
